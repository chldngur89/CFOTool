import { motion } from 'motion/react';

interface PixelCharacterProps {
  type: 'caocao' | 'soldier' | 'archer' | 'cavalry';
  animate?: boolean;
}

export function PixelCharacter({ type, animate = true }: PixelCharacterProps) {
  // 조조 - 16x16 픽셀 그리드
  const caocaoPixels = [
    [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
    [0,0,1,2,2,2,2,2,2,2,2,2,2,1,0,0],
    [0,1,2,2,3,3,2,2,2,2,3,3,2,2,1,0],
    [0,1,2,2,3,3,2,2,2,2,3,3,2,2,1,0],
    [0,1,2,2,2,2,2,4,4,2,2,2,2,2,1,0],
    [0,1,2,2,2,4,4,4,4,4,4,2,2,2,1,0],
    [0,0,1,2,2,2,4,4,4,4,2,2,2,1,0,0],
    [0,0,1,1,5,5,5,5,5,5,5,5,1,1,0,0],
    [0,1,5,5,5,5,5,5,5,5,5,5,5,5,1,0],
    [0,1,5,6,6,5,5,5,5,5,5,6,6,5,1,0],
    [0,1,5,6,6,5,5,5,5,5,5,6,6,5,1,0],
    [0,0,1,5,5,5,5,5,5,5,5,5,5,1,0,0],
    [0,0,1,6,6,1,1,1,1,1,1,6,6,1,0,0],
    [0,0,1,6,6,1,0,0,0,0,1,6,6,1,0,0],
    [0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0],
  ];

  // 황건적 병사 - 16x16 픽셀 그리드
  const soldierPixels = [
    [0,0,0,0,7,7,7,7,7,7,7,7,0,0,0,0],
    [0,0,0,7,7,7,7,7,7,7,7,7,7,0,0,0],
    [0,0,7,8,8,8,8,8,8,8,8,8,8,7,0,0],
    [0,7,8,8,9,9,8,8,8,8,9,9,8,8,7,0],
    [0,7,8,8,9,9,8,8,8,8,9,9,8,8,7,0],
    [0,7,8,8,8,8,8,10,10,8,8,8,8,8,7,0],
    [0,7,8,8,10,10,10,10,10,10,10,8,8,7,0],
    [0,0,7,8,8,10,10,10,10,10,8,8,7,0,0,0],
    [0,0,7,11,11,11,11,11,11,11,11,11,7,0,0,0],
    [0,7,11,11,11,11,11,11,11,11,11,11,11,7,0,0],
    [0,7,11,12,12,11,11,11,11,11,11,12,12,11,7,0],
    [0,7,11,12,12,11,11,11,11,11,11,12,12,11,7,0],
    [0,0,7,11,11,11,11,11,11,11,11,11,11,7,0,0],
    [0,0,7,12,12,7,7,7,7,7,7,12,12,7,0,0],
    [0,0,7,12,12,7,0,0,0,0,7,12,12,7,0,0],
    [0,0,0,7,7,0,0,0,0,0,0,7,7,0,0,0],
  ];

  // 궁수 - 16x16 픽셀 그리드
  const archerPixels = [
    [0,0,0,0,7,7,7,7,7,7,7,7,0,0,0,0],
    [0,0,0,7,7,7,7,7,7,7,7,7,7,0,0,0],
    [0,0,7,13,13,13,13,13,13,13,13,13,13,7,0,0],
    [0,7,13,13,9,9,13,13,13,13,9,9,13,13,7,0],
    [0,7,13,13,9,9,13,13,13,13,9,9,13,13,7,0],
    [0,7,13,13,13,13,13,14,14,13,13,13,13,13,7,0],
    [0,7,13,13,14,14,14,14,14,14,14,13,13,7,0,0],
    [0,0,7,13,13,14,14,14,14,14,13,13,7,0,0,0],
    [0,0,7,15,15,15,15,15,15,15,15,15,7,0,0,0],
    [0,7,15,15,15,15,15,15,15,15,15,15,15,7,0,0],
    [0,7,15,12,12,15,15,15,15,15,15,12,12,15,7,0],
    [0,7,15,12,12,15,15,15,15,15,15,12,12,15,7,0],
    [0,0,7,15,15,15,15,15,15,15,15,15,15,7,0,0],
    [0,0,7,12,12,7,7,7,7,7,7,12,12,7,0,0],
    [0,0,7,12,12,7,0,0,0,0,7,12,12,7,0,0],
    [0,0,0,7,7,0,0,0,0,0,0,7,7,0,0,0],
  ];

  // 기병 - 16x16 픽셀 그리드
  const cavalryPixels = [
    [0,0,0,0,7,7,7,7,7,7,7,7,0,0,0,0],
    [0,0,0,7,7,7,7,7,7,7,7,7,7,0,0,0],
    [0,0,7,16,16,16,16,16,16,16,16,16,16,7,0,0],
    [0,7,16,16,9,9,16,16,16,16,9,9,16,16,7,0],
    [0,7,16,16,9,9,16,16,16,16,9,9,16,16,7,0],
    [0,7,16,16,16,16,16,17,17,16,16,16,16,16,7,0],
    [0,7,16,16,17,17,17,17,17,17,17,16,16,7,0,0],
    [0,0,7,16,16,17,17,17,17,17,16,16,7,0,0,0],
    [0,0,7,18,18,18,18,18,18,18,18,18,7,0,0,0],
    [0,7,18,18,18,18,18,18,18,18,18,18,18,7,0,0],
    [0,7,18,12,12,18,18,18,18,18,18,12,12,18,7,0],
    [0,7,18,12,12,18,18,18,18,18,18,12,12,18,7,0],
    [0,0,7,18,18,18,18,18,18,18,18,18,18,7,0,0],
    [0,0,7,12,12,7,7,7,7,7,7,12,12,7,0,0],
    [0,0,7,12,12,7,0,0,0,0,7,12,12,7,0,0],
    [0,0,0,7,7,0,0,0,0,0,0,7,7,0,0,0],
  ];

  const getPixels = () => {
    switch (type) {
      case 'caocao': return caocaoPixels;
      case 'soldier': return soldierPixels;
      case 'archer': return archerPixels;
      case 'cavalry': return cavalryPixels;
    }
  };

  const getColor = (value: number) => {
    const colors: { [key: number]: string } = {
      0: 'transparent',
      1: '#000000', // 검정 (윤곽선)
      2: '#f5deb3', // 피부색
      3: '#654321', // 눈
      4: '#8b4513', // 수염
      5: '#8b0000', // 빨간 옷
      6: '#ffd700', // 금색 장식
      7: '#ffff00', // 노란 두건
      8: '#f5deb3', // 피부색
      9: '#654321', // 눈
      10: '#d2691e', // 수염
      11: '#ff6600', // 주황 옷
      12: '#8b4513', // 갈색
      13: '#f5deb3', // 피부색
      14: '#a0522d', // 갈색 수염
      15: '#ff8800', // 주황 옷
      16: '#f5deb3', // 피부색
      17: '#000000', // 검은 수염
      18: '#cc6600', // 갈색 옷
    };
    return colors[value] || 'transparent';
  };

  const pixels = getPixels();
  const pixelSize = type === 'caocao' ? 4 : 3;

  return (
    <motion.div
      animate={animate ? { y: [0, -4, 0] } : {}}
      transition={{ duration: 1, repeat: Infinity, repeatType: 'reverse' }}
      className="inline-block"
      style={{
        imageRendering: 'pixelated',
        imageRendering: '-moz-crisp-edges',
        imageRendering: 'crisp-edges',
      }}
    >
      <div className="grid" style={{ 
        gridTemplateColumns: `repeat(16, ${pixelSize}px)`,
        gap: 0,
      }}>
        {pixels.flat().map((pixel, index) => (
          <div
            key={index}
            style={{
              width: `${pixelSize}px`,
              height: `${pixelSize}px`,
              backgroundColor: getColor(pixel),
            }}
          />
        ))}
      </div>
    </motion.div>
  );
}
